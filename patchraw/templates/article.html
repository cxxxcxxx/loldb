{% extends "base.html" %}
{% block content %}
<div class="page-inner">
  <div class="page-title">{{ article.title }}</div>

  <div class="article-main">
    {% for block in blocks %}
      <div class="block-card">
        {% if block.type == 'text' %}
          <div class="article-text">{{ block.content }}</div>

        {% elif block.type == 'heading' %}
          <div class="article-heading">{{ block.content }}</div>

        {% elif block.type == 'image' %}
          {% if block.content %}
            <div class="article-image-container">
              <img src="{{ url_for('static', filename=block.content) }}" class="article-image" alt="">
            </div>
          {% endif %}

        {% elif block.type == 'item_grid' %}
          <div class="item-grid-title">Item Build</div>
          {% set items = build_items_by_block.get(block.id, []) %}
          <div class="item-build-grid" aria-label="Item Build">
            {% if items %}
              {% for path in items %}
                <div class="item-slot" title="{{ path }}">
                  <img src="{{ url_for('static', filename=path) }}" alt="item">
                </div>
              {% endfor %}
            {% else %}
              <div class="text-muted">Keine Items</div>
            {% endif %}
          </div>

        {% elif block.type == 'rune_grid' %}
          <div class="item-grid-title">Runen</div>
          {% set grouped = build_items_by_block.get(block.id, {'keystone':[],'subrune':[],'smallrune':[]}) %}
          <div class="rune-grid" role="list" aria-label="Runen Grid">
            {% for cat in ['keystone','subrune','smallrune'] %}
              {% if grouped[cat] %}
                <div class="rune-col" role="listitem">
                  {% for path in grouped[cat] %}
                    <img src="{{ url_for('static', filename=path) }}" class="rune-icon" alt="rune">
                  {% endfor %}
                </div>
              {% endif %}
            {% endfor %}
            {% if not (grouped.keystone or grouped.subrune or grouped.smallrune) %}
              <div class="text-muted">— Keine Runen —</div>
            {% endif %}
          </div>
        {% endif %}
      </div>
    {% endfor %}
  </div>
</div>
{% endblock %}

  